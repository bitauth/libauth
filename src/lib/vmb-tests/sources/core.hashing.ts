import { range } from '../../format/format.js';
import type { PossibleTestValue, VmbTestDefinitionGroup } from '../../lib.js';
import { generateTestCases, setExpectedResults } from '../bch-vmb-test-utils.js';

const hashOps: PossibleTestValue[] = [
  ['OP_RIPEMD160', 'OP_RIPEMD160'],
  ['OP_SHA1', 'OP_SHA1'],
  ['OP_SHA256', 'OP_SHA256'],
  ['OP_HASH160', 'OP_HASH160'],
  ['OP_HASH256', 'OP_HASH256'],
];

const byteLengths: PossibleTestValue[] = [...range(56, 1), 64, 119, 120, 183, 184, 247, 248, 488, 503, 504, 520, 521, 1015, 1016].map((i) => [`${i}`, `${i}`]);

export default [
  [
    'Hashing operations',
    [
      ...setExpectedResults(
        generateTestCases(
          ['<$(<0> <$1> OP_NUM2BIN $0)>', '<0> <$1> OP_NUM2BIN $0 OP_EQUAL', '$0 $1 bytes (0x00)'],
          [
            hashOps,
            [
              ['0', '0'],
              ['16', '16'],
              ['32', '32'],
              ['55', '55'],
              ['56', '56'],
              ['64', '64'],
            ],
          ],
        ),
        {
          'OP_HASH160 0 bytes (0x00)': [],
          'OP_HASH160 16 bytes (0x00)': [],
          'OP_HASH160 32 bytes (0x00)': [],
          'OP_HASH160 55 bytes (0x00)': [],
          'OP_HASH160 56 bytes (0x00)': [],
          'OP_HASH160 64 bytes (0x00)': [],
          'OP_HASH256 0 bytes (0x00)': [],
          'OP_HASH256 16 bytes (0x00)': [],
          'OP_HASH256 32 bytes (0x00)': [],
          'OP_HASH256 55 bytes (0x00)': [],
          'OP_HASH256 56 bytes (0x00)': [],
          'OP_HASH256 64 bytes (0x00)': [],
          'OP_RIPEMD160 0 bytes (0x00)': [],
          'OP_RIPEMD160 16 bytes (0x00)': [],
          'OP_RIPEMD160 32 bytes (0x00)': [],
          'OP_RIPEMD160 55 bytes (0x00)': [],
          'OP_RIPEMD160 56 bytes (0x00)': [],
          'OP_RIPEMD160 64 bytes (0x00)': [],
          'OP_SHA1 0 bytes (0x00)': [],
          'OP_SHA1 16 bytes (0x00)': [],
          'OP_SHA1 32 bytes (0x00)': [],
          'OP_SHA1 55 bytes (0x00)': [],
          'OP_SHA1 56 bytes (0x00)': [],
          'OP_SHA1 64 bytes (0x00)': [],
          'OP_SHA256 0 bytes (0x00)': [],
          'OP_SHA256 16 bytes (0x00)': [],
          'OP_SHA256 32 bytes (0x00)': [],
          'OP_SHA256 55 bytes (0x00)': [],
          'OP_SHA256 56 bytes (0x00)': [],
          'OP_SHA256 64 bytes (0x00)': [],
        },
      ),

      ...setExpectedResults(generateTestCases(['<$(<1> <$1> OP_NUM2BIN $0)>', '<1> <$1> OP_NUM2BIN $0 OP_EQUAL', '$0 $1 bytes'], [hashOps, byteLengths]), {
        'OP_HASH160 1 bytes': [],
        'OP_HASH160 10 bytes': [],
        'OP_HASH160 1015 bytes': ['2023_invalid'],
        'OP_HASH160 1016 bytes': ['2023_invalid'],
        'OP_HASH160 11 bytes': [],
        'OP_HASH160 119 bytes': [],
        'OP_HASH160 12 bytes': [],
        'OP_HASH160 120 bytes': [],
        'OP_HASH160 13 bytes': [],
        'OP_HASH160 14 bytes': [],
        'OP_HASH160 15 bytes': [],
        'OP_HASH160 16 bytes': [],
        'OP_HASH160 17 bytes': [],
        'OP_HASH160 18 bytes': [],
        'OP_HASH160 183 bytes': [],
        'OP_HASH160 184 bytes': [],
        'OP_HASH160 19 bytes': [],
        'OP_HASH160 2 bytes': [],
        'OP_HASH160 20 bytes': [],
        'OP_HASH160 21 bytes': [],
        'OP_HASH160 22 bytes': [],
        'OP_HASH160 23 bytes': [],
        'OP_HASH160 24 bytes': [],
        'OP_HASH160 247 bytes': [],
        'OP_HASH160 248 bytes': [],
        'OP_HASH160 25 bytes': [],
        'OP_HASH160 26 bytes': [],
        'OP_HASH160 27 bytes': [],
        'OP_HASH160 28 bytes': [],
        'OP_HASH160 29 bytes': [],
        'OP_HASH160 3 bytes': [],
        'OP_HASH160 30 bytes': [],
        'OP_HASH160 31 bytes': [],
        'OP_HASH160 32 bytes': [],
        'OP_HASH160 33 bytes': [],
        'OP_HASH160 34 bytes': [],
        'OP_HASH160 35 bytes': [],
        'OP_HASH160 36 bytes': [],
        'OP_HASH160 37 bytes': [],
        'OP_HASH160 38 bytes': [],
        'OP_HASH160 39 bytes': [],
        'OP_HASH160 4 bytes': [],
        'OP_HASH160 40 bytes': [],
        'OP_HASH160 41 bytes': [],
        'OP_HASH160 42 bytes': [],
        'OP_HASH160 43 bytes': [],
        'OP_HASH160 44 bytes': [],
        'OP_HASH160 45 bytes': [],
        'OP_HASH160 46 bytes': [],
        'OP_HASH160 47 bytes': [],
        'OP_HASH160 48 bytes': [],
        'OP_HASH160 488 bytes': [],
        'OP_HASH160 49 bytes': [],
        'OP_HASH160 5 bytes': [],
        'OP_HASH160 50 bytes': [],
        'OP_HASH160 503 bytes': [],
        'OP_HASH160 504 bytes': [],
        'OP_HASH160 51 bytes': [],
        'OP_HASH160 52 bytes': [],
        'OP_HASH160 520 bytes': [],
        'OP_HASH160 521 bytes': ['2023_invalid'],
        'OP_HASH160 53 bytes': [],
        'OP_HASH160 54 bytes': [],
        'OP_HASH160 55 bytes': [],
        'OP_HASH160 56 bytes': [],
        'OP_HASH160 6 bytes': [],
        'OP_HASH160 64 bytes': [],
        'OP_HASH160 7 bytes': [],
        'OP_HASH160 8 bytes': [],
        'OP_HASH160 9 bytes': [],
        'OP_HASH256 1 bytes': [],
        'OP_HASH256 10 bytes': [],
        'OP_HASH256 1015 bytes': ['2023_invalid'],
        'OP_HASH256 1016 bytes': ['2023_invalid'],
        'OP_HASH256 11 bytes': [],
        'OP_HASH256 119 bytes': [],
        'OP_HASH256 12 bytes': [],
        'OP_HASH256 120 bytes': [],
        'OP_HASH256 13 bytes': [],
        'OP_HASH256 14 bytes': [],
        'OP_HASH256 15 bytes': [],
        'OP_HASH256 16 bytes': [],
        'OP_HASH256 17 bytes': [],
        'OP_HASH256 18 bytes': [],
        'OP_HASH256 183 bytes': [],
        'OP_HASH256 184 bytes': [],
        'OP_HASH256 19 bytes': [],
        'OP_HASH256 2 bytes': [],
        'OP_HASH256 20 bytes': [],
        'OP_HASH256 21 bytes': [],
        'OP_HASH256 22 bytes': [],
        'OP_HASH256 23 bytes': [],
        'OP_HASH256 24 bytes': [],
        'OP_HASH256 247 bytes': [],
        'OP_HASH256 248 bytes': [],
        'OP_HASH256 25 bytes': [],
        'OP_HASH256 26 bytes': [],
        'OP_HASH256 27 bytes': [],
        'OP_HASH256 28 bytes': [],
        'OP_HASH256 29 bytes': [],
        'OP_HASH256 3 bytes': [],
        'OP_HASH256 30 bytes': [],
        'OP_HASH256 31 bytes': [],
        'OP_HASH256 32 bytes': [],
        'OP_HASH256 33 bytes': [],
        'OP_HASH256 34 bytes': [],
        'OP_HASH256 35 bytes': [],
        'OP_HASH256 36 bytes': [],
        'OP_HASH256 37 bytes': [],
        'OP_HASH256 38 bytes': [],
        'OP_HASH256 39 bytes': [],
        'OP_HASH256 4 bytes': [],
        'OP_HASH256 40 bytes': [],
        'OP_HASH256 41 bytes': [],
        'OP_HASH256 42 bytes': [],
        'OP_HASH256 43 bytes': [],
        'OP_HASH256 44 bytes': [],
        'OP_HASH256 45 bytes': [],
        'OP_HASH256 46 bytes': [],
        'OP_HASH256 47 bytes': [],
        'OP_HASH256 48 bytes': [],
        'OP_HASH256 488 bytes': [],
        'OP_HASH256 49 bytes': [],
        'OP_HASH256 5 bytes': [],
        'OP_HASH256 50 bytes': [],
        'OP_HASH256 503 bytes': [],
        'OP_HASH256 504 bytes': [],
        'OP_HASH256 51 bytes': [],
        'OP_HASH256 52 bytes': [],
        'OP_HASH256 520 bytes': [],
        'OP_HASH256 521 bytes': ['2023_invalid'],
        'OP_HASH256 53 bytes': [],
        'OP_HASH256 54 bytes': [],
        'OP_HASH256 55 bytes': [],
        'OP_HASH256 56 bytes': [],
        'OP_HASH256 6 bytes': [],
        'OP_HASH256 64 bytes': [],
        'OP_HASH256 7 bytes': [],
        'OP_HASH256 8 bytes': [],
        'OP_HASH256 9 bytes': [],
        'OP_RIPEMD160 1 bytes': [],
        'OP_RIPEMD160 10 bytes': [],
        'OP_RIPEMD160 1015 bytes': ['2023_invalid'],
        'OP_RIPEMD160 1016 bytes': ['2023_invalid'],
        'OP_RIPEMD160 11 bytes': [],
        'OP_RIPEMD160 119 bytes': [],
        'OP_RIPEMD160 12 bytes': [],
        'OP_RIPEMD160 120 bytes': [],
        'OP_RIPEMD160 13 bytes': [],
        'OP_RIPEMD160 14 bytes': [],
        'OP_RIPEMD160 15 bytes': [],
        'OP_RIPEMD160 16 bytes': [],
        'OP_RIPEMD160 17 bytes': [],
        'OP_RIPEMD160 18 bytes': [],
        'OP_RIPEMD160 183 bytes': [],
        'OP_RIPEMD160 184 bytes': [],
        'OP_RIPEMD160 19 bytes': [],
        'OP_RIPEMD160 2 bytes': [],
        'OP_RIPEMD160 20 bytes': [],
        'OP_RIPEMD160 21 bytes': [],
        'OP_RIPEMD160 22 bytes': [],
        'OP_RIPEMD160 23 bytes': [],
        'OP_RIPEMD160 24 bytes': [],
        'OP_RIPEMD160 247 bytes': [],
        'OP_RIPEMD160 248 bytes': [],
        'OP_RIPEMD160 25 bytes': [],
        'OP_RIPEMD160 26 bytes': [],
        'OP_RIPEMD160 27 bytes': [],
        'OP_RIPEMD160 28 bytes': [],
        'OP_RIPEMD160 29 bytes': [],
        'OP_RIPEMD160 3 bytes': [],
        'OP_RIPEMD160 30 bytes': [],
        'OP_RIPEMD160 31 bytes': [],
        'OP_RIPEMD160 32 bytes': [],
        'OP_RIPEMD160 33 bytes': [],
        'OP_RIPEMD160 34 bytes': [],
        'OP_RIPEMD160 35 bytes': [],
        'OP_RIPEMD160 36 bytes': [],
        'OP_RIPEMD160 37 bytes': [],
        'OP_RIPEMD160 38 bytes': [],
        'OP_RIPEMD160 39 bytes': [],
        'OP_RIPEMD160 4 bytes': [],
        'OP_RIPEMD160 40 bytes': [],
        'OP_RIPEMD160 41 bytes': [],
        'OP_RIPEMD160 42 bytes': [],
        'OP_RIPEMD160 43 bytes': [],
        'OP_RIPEMD160 44 bytes': [],
        'OP_RIPEMD160 45 bytes': [],
        'OP_RIPEMD160 46 bytes': [],
        'OP_RIPEMD160 47 bytes': [],
        'OP_RIPEMD160 48 bytes': [],
        'OP_RIPEMD160 488 bytes': [],
        'OP_RIPEMD160 49 bytes': [],
        'OP_RIPEMD160 5 bytes': [],
        'OP_RIPEMD160 50 bytes': [],
        'OP_RIPEMD160 503 bytes': [],
        'OP_RIPEMD160 504 bytes': [],
        'OP_RIPEMD160 51 bytes': [],
        'OP_RIPEMD160 52 bytes': [],
        'OP_RIPEMD160 520 bytes': [],
        'OP_RIPEMD160 521 bytes': ['2023_invalid'],
        'OP_RIPEMD160 53 bytes': [],
        'OP_RIPEMD160 54 bytes': [],
        'OP_RIPEMD160 55 bytes': [],
        'OP_RIPEMD160 56 bytes': [],
        'OP_RIPEMD160 6 bytes': [],
        'OP_RIPEMD160 64 bytes': [],
        'OP_RIPEMD160 7 bytes': [],
        'OP_RIPEMD160 8 bytes': [],
        'OP_RIPEMD160 9 bytes': [],
        'OP_SHA1 1 bytes': [],
        'OP_SHA1 10 bytes': [],
        'OP_SHA1 1015 bytes': ['2023_invalid'],
        'OP_SHA1 1016 bytes': ['2023_invalid'],
        'OP_SHA1 11 bytes': [],
        'OP_SHA1 119 bytes': [],
        'OP_SHA1 12 bytes': [],
        'OP_SHA1 120 bytes': [],
        'OP_SHA1 13 bytes': [],
        'OP_SHA1 14 bytes': [],
        'OP_SHA1 15 bytes': [],
        'OP_SHA1 16 bytes': [],
        'OP_SHA1 17 bytes': [],
        'OP_SHA1 18 bytes': [],
        'OP_SHA1 183 bytes': [],
        'OP_SHA1 184 bytes': [],
        'OP_SHA1 19 bytes': [],
        'OP_SHA1 2 bytes': [],
        'OP_SHA1 20 bytes': [],
        'OP_SHA1 21 bytes': [],
        'OP_SHA1 22 bytes': [],
        'OP_SHA1 23 bytes': [],
        'OP_SHA1 24 bytes': [],
        'OP_SHA1 247 bytes': [],
        'OP_SHA1 248 bytes': [],
        'OP_SHA1 25 bytes': [],
        'OP_SHA1 26 bytes': [],
        'OP_SHA1 27 bytes': [],
        'OP_SHA1 28 bytes': [],
        'OP_SHA1 29 bytes': [],
        'OP_SHA1 3 bytes': [],
        'OP_SHA1 30 bytes': [],
        'OP_SHA1 31 bytes': [],
        'OP_SHA1 32 bytes': [],
        'OP_SHA1 33 bytes': [],
        'OP_SHA1 34 bytes': [],
        'OP_SHA1 35 bytes': [],
        'OP_SHA1 36 bytes': [],
        'OP_SHA1 37 bytes': [],
        'OP_SHA1 38 bytes': [],
        'OP_SHA1 39 bytes': [],
        'OP_SHA1 4 bytes': [],
        'OP_SHA1 40 bytes': [],
        'OP_SHA1 41 bytes': [],
        'OP_SHA1 42 bytes': [],
        'OP_SHA1 43 bytes': [],
        'OP_SHA1 44 bytes': [],
        'OP_SHA1 45 bytes': [],
        'OP_SHA1 46 bytes': [],
        'OP_SHA1 47 bytes': [],
        'OP_SHA1 48 bytes': [],
        'OP_SHA1 488 bytes': [],
        'OP_SHA1 49 bytes': [],
        'OP_SHA1 5 bytes': [],
        'OP_SHA1 50 bytes': [],
        'OP_SHA1 503 bytes': [],
        'OP_SHA1 504 bytes': [],
        'OP_SHA1 51 bytes': [],
        'OP_SHA1 52 bytes': [],
        'OP_SHA1 520 bytes': [],
        'OP_SHA1 521 bytes': ['2023_invalid'],
        'OP_SHA1 53 bytes': [],
        'OP_SHA1 54 bytes': [],
        'OP_SHA1 55 bytes': [],
        'OP_SHA1 56 bytes': [],
        'OP_SHA1 6 bytes': [],
        'OP_SHA1 64 bytes': [],
        'OP_SHA1 7 bytes': [],
        'OP_SHA1 8 bytes': [],
        'OP_SHA1 9 bytes': [],
        'OP_SHA256 1 bytes': [],
        'OP_SHA256 10 bytes': [],
        'OP_SHA256 1015 bytes': ['2023_invalid'],
        'OP_SHA256 1016 bytes': ['2023_invalid'],
        'OP_SHA256 11 bytes': [],
        'OP_SHA256 119 bytes': [],
        'OP_SHA256 12 bytes': [],
        'OP_SHA256 120 bytes': [],
        'OP_SHA256 13 bytes': [],
        'OP_SHA256 14 bytes': [],
        'OP_SHA256 15 bytes': [],
        'OP_SHA256 16 bytes': [],
        'OP_SHA256 17 bytes': [],
        'OP_SHA256 18 bytes': [],
        'OP_SHA256 183 bytes': [],
        'OP_SHA256 184 bytes': [],
        'OP_SHA256 19 bytes': [],
        'OP_SHA256 2 bytes': [],
        'OP_SHA256 20 bytes': [],
        'OP_SHA256 21 bytes': [],
        'OP_SHA256 22 bytes': [],
        'OP_SHA256 23 bytes': [],
        'OP_SHA256 24 bytes': [],
        'OP_SHA256 247 bytes': [],
        'OP_SHA256 248 bytes': [],
        'OP_SHA256 25 bytes': [],
        'OP_SHA256 26 bytes': [],
        'OP_SHA256 27 bytes': [],
        'OP_SHA256 28 bytes': [],
        'OP_SHA256 29 bytes': [],
        'OP_SHA256 3 bytes': [],
        'OP_SHA256 30 bytes': [],
        'OP_SHA256 31 bytes': [],
        'OP_SHA256 32 bytes': [],
        'OP_SHA256 33 bytes': [],
        'OP_SHA256 34 bytes': [],
        'OP_SHA256 35 bytes': [],
        'OP_SHA256 36 bytes': [],
        'OP_SHA256 37 bytes': [],
        'OP_SHA256 38 bytes': [],
        'OP_SHA256 39 bytes': [],
        'OP_SHA256 4 bytes': [],
        'OP_SHA256 40 bytes': [],
        'OP_SHA256 41 bytes': [],
        'OP_SHA256 42 bytes': [],
        'OP_SHA256 43 bytes': [],
        'OP_SHA256 44 bytes': [],
        'OP_SHA256 45 bytes': [],
        'OP_SHA256 46 bytes': [],
        'OP_SHA256 47 bytes': [],
        'OP_SHA256 48 bytes': [],
        'OP_SHA256 488 bytes': [],
        'OP_SHA256 49 bytes': [],
        'OP_SHA256 5 bytes': [],
        'OP_SHA256 50 bytes': [],
        'OP_SHA256 503 bytes': [],
        'OP_SHA256 504 bytes': [],
        'OP_SHA256 51 bytes': [],
        'OP_SHA256 52 bytes': [],
        'OP_SHA256 520 bytes': [],
        'OP_SHA256 521 bytes': ['2023_invalid'],
        'OP_SHA256 53 bytes': [],
        'OP_SHA256 54 bytes': [],
        'OP_SHA256 55 bytes': [],
        'OP_SHA256 56 bytes': [],
        'OP_SHA256 6 bytes': [],
        'OP_SHA256 64 bytes': [],
        'OP_SHA256 7 bytes': [],
        'OP_SHA256 8 bytes': [],
        'OP_SHA256 9 bytes': [],
      }),
    ],
  ],
] as const satisfies VmbTestDefinitionGroup[];
